# references:
# http://www.pp.rhul.ac.uk/~cowan/atlas/ErrorBars.pdf
# 
# using Distributions

# poissonquantile(n) = [
#     n==0 ? 0.0 : quantile(Chisq(2n), 0.159),
#     quantile(Chisq(2*(n+1)), 1-0.159)] ./ 2

# const poissonerr = [poissonquantile(n) for n in 0:100];

const poissonerr = [
    [0.0, 1.838851076761905], [0.173163619009189, 3.296697866399274],
    [0.7091735948304174, 4.6345507336608875], [1.3687423128942924, 5.914479679188524],
    [2.0874953911076477, 7.158700455531753], [2.842484490497317, 8.378108507829323],
    [3.6225521367066253, 9.578992181272188], [4.4212958064674375, 10.765366657764186],
    [5.234643080552287, 11.93997939698542], [6.05981476039222, 13.104807798135454],
    [6.894814466904441, 14.261330958821924], [7.7381510690369355, 15.410689401090716],
    [8.588676051676018, 16.553784484708252], [9.445482540370776, 17.69134319130975],
    [10.307839626891383, 18.823961964764877], [11.1751479962014, 19.952137329234912],
    [12.04690897644852, 21.076287853168505], [12.922702360783255, 22.1967702723296],
    [13.802170141927066, 23.313891564510037], [14.68500434027511, 24.427918152695682],
    [15.570937732864735, 25.539083029472483], [16.45973668060356, 26.647591349142353],
    [17.35119550105274, 27.753624871980865], [18.245131998276445, 28.85734553605287],
    [19.141383871642404, 29.958898357166845], [20.039805801161457, 31.05841380523435],
    [20.940267059833843, 32.15600976812415], [21.8426495410242, 33.251793187279134],
    [22.746846115962978, 34.34586142974826], [23.652759256263924, 35.438303446756144],
    [24.560299870999607, 36.529200758044915], [25.469386318851708, 37.6186282929761],
    [26.379943564162236, 38.70665511307066], [27.29190245206665, 39.7933450357933],
    [28.205199082795303, 40.87875717559208], [29.119774269049223, 41.962946415224344],
    [30.03557306335486, 43.04596381804241], [30.952544344674045, 44.12785699003307],
    [31.87064045543518, 45.20867039889818], [32.789816881666965, 46.288445656246395],
    [33.710031970139326, 47.36722176797792], [34.63124667740944, 48.445035357136916],
    [35.55342434648161, 49.521920862843686], [36.47653050745587, 50.597910718371466],
    [37.40053269908923, 51.6730355109793], [38.325400308649385, 52.74732412573457],
    [39.251104427819676, 53.82080387524273], [40.177617722731995, 54.89350061693583],
    [41.10491431647037, 55.96543885934793], [42.03296968261348, 57.03664185861526],
    [42.96176054857424, 58.10713170627818], [43.89126480765641, 59.17692940932434],
    [44.821461438886644, 60.24605496329476], [45.752330433797425, 61.314527419174055],
    [46.68385272943863, 62.382364944698416], [47.61601014698173, 63.44958488064066],
    [48.548785335356634, 64.5162037925661], [49.48216171942576, 65.58223751849708],
    [50.4161234522569, 66.64770121287437], [51.350655371105354, 67.71260938716142],
    [52.28574295675917, 68.77697594739928], [53.221372295938515, 69.84081422898767],
    [54.15753004647334, 70.90413702893844], [55.094203405012635, 71.96695663582253],
    [56.031380077043714, 73.02928485760867], [56.96904824902285, 74.09113304757257],
    [57.907196562438216, 75.15251212843742], [58.845814089643945, 76.21343261489143],
    [59.78489031131967, 77.27390463461316], [60.72441509542384, 78.33393794792454],
    [61.66437867752166, 79.39354196617872], [62.60477164237937, 80.45272576898152],
    [63.54558490672675, 81.51149812033526], [64.48680970309846, 82.56986748378634],
    [65.42843756467266, 83.62784203665086], [66.37046031103304, 84.68542968338575],
    [67.31287003478607, 85.74263806816731], [68.2556590889717, 86.79947458673415],
    [69.19882007521075, 87.8559463975459], [70.14234583253705, 88.91206043230599],
    [71.08622942686627, 89.96782340589162], [72.03046414105813, 91.02324182573192],
    [72.97504346553114, 92.07832200067062], [73.91996108939314, 93.13307004934804],
    [74.86521089205318, 94.18749190813342], [75.81078693528339, 95.24159333863713],
    [76.7566834557014, 96.29537993482926], [77.70289485764685, 97.34885712978978],
    [78.6494157064264, 98.40203020211322], [79.59624072190486, 99.45490428198924],
    [80.54336477242062, 100.50748435697882], [81.49078286900543, 101.55977527750473],
    [82.43849015989073, 102.61178176207308], [83.38648192528254, 103.66350840224206],
    [84.33475357238972, 104.71495966735264], [85.28330063069038, 105.76613990903502],
    [86.23211874742275, 106.81705336550353], [87.18120368328765, 107.86770416565227],
    [88.13055130835048, 108.91809633296259], [89.08015759813156, 109.96823378923257],
    [90.03001862987449, 111.01812035813877]];
# 
# 
yerror_poisson(n) = n â‰¤ 100 ?
    (poissonerr[n+1] .- n).*[-1, 1] :
    sqrt(n).*[1,1] # error of < 5% when n > 100
